<div class="content-wrapper">
	<section class="content-header">
		<ol class="breadcrumb">
			<li><a ui-sref="home"><i class="fa fa-dashboard"></i> خانه</a></li>
			<li class="active">گزارشات سیستم</li>
			<div class="clear"></div>
		</ol>
		<h1 class="hidden-xs">
			گزارسات سیستم
		</h1>
		<div class="clear"></div>
	</section>
	<section class="content reported">

		<div  ng-show='loading'>
			<div id="mySpinner"  class="loader">Loading...</div>
		</div>
		<script type="text/javascript">
			if (!String.prototype.format) {
				String.prototype.format = function() {
					var args = arguments;
					return this.replace(/{(\d+)}/g, function(match, number) { 
						return typeof args[number] != 'undefined'
						? args[number]
						: match
						;
					});
				};
			}else{
				console.log("format of text in implemented");
			}
			var $grid = 0;
			var clid = 'mqttjs_' + Math.random().toString(16).substr(2, 8);
			client = new Paho.MQTT.Client("79.127.125.98", 10001, clid);

			client.onConnectionLost = onConnectionLost;
			client.onMessageArrived = onMessageArrived;

			client.connect({onSuccess:onConnect});

			function onConnect() {
				console.log("onConnect");
				client.subscribe("wisgoon/check/porn");
			}

// called when the client loses its connection
function onConnectionLost(responseObject) {
	if (responseObject.errorCode !== 0) {
		console.log("onConnectionLost:"+responseObject.errorMessage);
	}
}

// called when a message arrives
function onMessageArrived(message) {
	console.log("onMessageArrived:"+message.payloadString);
	var obj = jQuery.parseJSON( message.payloadString );
	s = "<div class='grid-item'><a target='_blank' href='http://wisgoon.com/pin/{0}/'><img src='{1}' style='width:236px; height:{2}px'></a> score:{3}</div>".format(obj.id, obj.image, obj.h, obj.number);
  // $("div.grid").prepend(s);
  $items = $(s);
  $grid.prepend($items).masonry('prepended', $items );
}

</script>
<div id="feed" load-images="false" class="resize" masonry reload-on-resize  style="width:1070px;">
</div>
</section>
</div>